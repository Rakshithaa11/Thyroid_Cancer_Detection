{% extends 'base.html' %}
{% block body_class %}thyroid-prediction-bg{% endblock %}

{% block title %}Thyroid Predictions - ThyroidAI{% endblock %}

{% block content %}
<section class="container py-5">
    <div class="text-center mb-5">
        <h1 class="fw-bold text-primary">ü©∫ Thyroid Prediction System</h1>
    </div>

    <!-- Flash messages -->
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <div class="mb-4">
          {% for category, message in messages %}
            <div class="alert alert-{{ 'success' if category == 'success' else 'danger' }} text-center">
              {{ message }}
            </div>
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}

    <!-- Prediction Form -->
    <div class="card shadow-sm mb-5">
        <div class="card-body">
            <h4 class="mb-4 text-secondary">üîç Enter Patient Details</h4>
            <form method="POST" action="{{ url_for('thyrocheck') }}" class="row g-3">
                <div class="col-md-6">
                    <label class="form-label">Full Name</label>
                    <input type="text" name="name" class="form-control" required>
                </div>

                <div class="col-md-3">
                    <label class="form-label">Age</label>
                    <input type="number" name="age" class="form-control" required>
                </div>

                <div class="col-md-3">
                    <label class="form-label">Gender</label>
                    <select name="gender" class="form-select" required>
                        <option value="">--Select--</option>
                        <option value="Male">Male</option>
                        <option value="Female">Female</option>
                    </select>
                </div>

                <div class="col-md-4">
                    <label class="form-label">TSH</label>
                    <input type="number" step="any" name="tsh" class="form-control" required>
                </div>

                <div class="col-md-4">
                    <label class="form-label">T3</label>
                    <input type="number" step="any" name="t3" class="form-control" required>
                </div>

                <div class="col-md-4">
                    <label class="form-label">T4</label>
                    <input type="number" step="any" name="t4" class="form-control" required>
                </div>

                <!-- Symptoms Dropdown -->
                <div class="col-12">
                    <label class="form-label">Symptoms</label>
                    <select name="symptoms" id="symptoms" class="form-select" multiple="multiple" required>
                        <option value="Fatigue">Fatigue</option>
                        <option value="Weight Gain">Weight Gain</option>
                        <option value="Depression">Depression</option>
                        <option value="Hair Loss">Hair Loss</option>
                        <option value="Cold Intolerance">Cold Intolerance</option>
                        <option value="Constipation">Constipation</option>
                        <option value="Dry Skin">Dry Skin</option>
                        <option value="Goiter">Swelling in Neck (Goiter)</option>
                        <option value="Weight Loss">Weight Loss</option>
                        <option value="Heat Intolerance">Heat Intolerance</option>
                        <option value="Tremors">Tremors</option>
                        <option value="Palpitations">Palpitations</option>
                        <option value="Bulging Eyes">Bulging Eyes</option>
                        <option value="Diarrhea">Diarrhea</option>
                        <option value="Anxiety">Anxiety</option>
                    </select>
                </div>

                <div class="col-12 text-center mt-3">
                    <button type="submit" class="btn btn-primary px-5">Predict</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Predictions Table -->
    <div class="card shadow-sm">
        <div class="card-body">
            <h4 class="mb-4 text-secondary">üìä Previous Predictions</h4>
            {% if predictions %}
                <div class="table-responsive">
                    <table class="table table-striped table-hover align-middle">
                        <thead class="table-light">
                            <tr>
                                <th>ID</th>
                                <th>Patient</th>
                                <th>Age</th>
                                <th>Gender</th>
                                <th>TSH</th>
                                <th>T3</th>
                                <th>T4</th>
                                <th>Symptoms</th>
                                <th>Result</th>
                                <th>Predicted At</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for row in predictions %}
                            <tr>
                                <td>{{ row.prediction_id }}</td>
                                <td>{{ row.name }}</td>
                                <td>{{ row.age }}</td>
                                <td>{{ row.gender }}</td>
                                <td>{{ row.tsh }}</td>
                                <td>{{ row.t3 }}</td>
                                <td>{{ row.t4 }}</td>
                                <td>{{ row.symptom }}</td>
                                <td>{{ row.result }}</td>
                                <td>{{ row.predicted_at }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            {% else %}
                <p class="text-muted">No predictions yet.</p>
            {% endif %}
        </div>
    </div>
</section>
{% endblock %}
